<% layout("./layouts/boilerplate") -%>

<div class="container my-4">
  <h2 class="mb-4" style="color: #fe424d">My Account</h2>

  <!-- User Info -->
  <div class="card mb-4 p-3">
    <div class="card-body">
      <h5 class="card-title">Account Information</h5>
      <p>
        <strong>Name:</strong>
        <%= user.firstName || "" %> <%= user.lastName || "" %>
      </p>
      <p><strong>Username:</strong> <%= user.username %></p>
      <p><strong>Email:</strong> <%= user.email %></p>
      <p><strong>Gender:</strong> <%= user.gender || "—" %></p>
    </div>
    <div class="d-flex gap-2 mt-3 flex-wrap">
      <a href="/account/edit" class="btn btn-outline-dark btn-sm" style="border: #fe424d; background-color: transparent; color: #fe424d;">
        Edit Profile
      </a>

      <a href="/change-password" class="btn btn-outline-dark btn-sm">
        Change Password
      </a>
    </div>
  </div>

  <!-- My Listings -->
  <div class="card mb-4 p-3">
    <div class="card-body">
      <h5 class="card-title">My Listings</h5>

      <% if (listings.length === 0) { %>
      <p class="text-muted">You haven’t created any listings yet.</p>
      <% } else { %>
      <ul class="list-group">
        <% listings.forEach(listing => { %>
        <li
          class="list-group-item d-flex justify-content-between align-items-center"
        >
          <a href="/listings/<%= listing._id %>" style="text-decoration: none">
            <%= listing.title %>
          </a>
          <a
            href="/listings/<%= listing._id %>/edit"
            class="btn btn-sm btn-outline-dark"
          >
            Edit
          </a>
        </li>
        <% }) %>
      </ul>
      <% } %>
    </div>
  </div>

  <!-- My Reviews -->
  <div class="card p-3">
    <div class="card-body">
      <h5 class="card-title">My Reviews</h5>

      <% if (reviews.length === 0) { %>
      <p class="text-muted">You haven’t written any reviews yet.</p>
      <% } else { %>
      <ul class="list-group">
        <% reviews.forEach(review => { %>
        <li class="list-group-item">
          ⭐ <%= review.rating %>/5
          <p class="mb-0"><%= review.comment %></p>
        </li>
        <% }) %>
      </ul>
      <% } %>
    </div>
  </div>
</div>
